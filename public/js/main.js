!function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=4)}([function(t,e,n){var r=n(1),i=n(2);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[t.i,i,""]]);var a={insert:"head",singleton:!1};r(i,a);t.exports=i.locals||{}},function(t,e,n){"use strict";var r,i=function(){return void 0===r&&(r=Boolean(window&&document&&document.all&&!window.atob)),r},a=function(){var t={};return function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(t){n=null}t[e]=n}return t[e]}}(),s=[];function o(t){for(var e=-1,n=0;n<s.length;n++)if(s[n].identifier===t){e=n;break}return e}function c(t,e){for(var n={},r=[],i=0;i<t.length;i++){var a=t[i],c=e.base?a[0]+e.base:a[0],l=n[c]||0,u="".concat(c," ").concat(l);n[c]=l+1;var d=o(u),h={css:a[1],media:a[2],sourceMap:a[3]};-1!==d?(s[d].references++,s[d].updater(h)):s.push({identifier:u,updater:_(h,e),references:1}),r.push(u)}return r}function l(t){var e=document.createElement("style"),r=t.attributes||{};if(void 0===r.nonce){var i=n.nc;i&&(r.nonce=i)}if(Object.keys(r).forEach((function(t){e.setAttribute(t,r[t])})),"function"==typeof t.insert)t.insert(e);else{var s=a(t.insert||"head");if(!s)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");s.appendChild(e)}return e}var u,d=(u=[],function(t,e){return u[t]=e,u.filter(Boolean).join("\n")});function h(t,e,n,r){var i=n?"":r.media?"@media ".concat(r.media," {").concat(r.css,"}"):r.css;if(t.styleSheet)t.styleSheet.cssText=d(e,i);else{var a=document.createTextNode(i),s=t.childNodes;s[e]&&t.removeChild(s[e]),s.length?t.insertBefore(a,s[e]):t.appendChild(a)}}function p(t,e,n){var r=n.css,i=n.media,a=n.sourceMap;if(i?t.setAttribute("media",i):t.removeAttribute("media"),a&&btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(a))))," */")),t.styleSheet)t.styleSheet.cssText=r;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(r))}}var m=null,f=0;function _(t,e){var n,r,i;if(e.singleton){var a=f++;n=m||(m=l(e)),r=h.bind(null,n,a,!1),i=h.bind(null,n,a,!0)}else n=l(e),r=p.bind(null,n,e),i=function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(n)};return r(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;r(t=e)}else i()}}t.exports=function(t,e){(e=e||{}).singleton||"boolean"==typeof e.singleton||(e.singleton=i());var n=c(t=t||[],e);return function(t){if(t=t||[],"[object Array]"===Object.prototype.toString.call(t)){for(var r=0;r<n.length;r++){var i=o(n[r]);s[i].references--}for(var a=c(t,e),l=0;l<n.length;l++){var u=o(n[l]);0===s[u].references&&(s[u].updater(),s.splice(u,1))}n=a}}}},function(t,e,n){(e=n(3)(!1)).push([t.i,"* {\n  background: red;\n}\n",""]),t.exports=e},function(t,e,n){"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n=function(t,e){var n=t[1]||"",r=t[3];if(!r)return n;if(e&&"function"==typeof btoa){var i=(s=r,o=btoa(unescape(encodeURIComponent(JSON.stringify(s)))),c="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(o),"/*# ".concat(c," */")),a=r.sources.map((function(t){return"/*# sourceURL=".concat(r.sourceRoot||"").concat(t," */")}));return[n].concat(a).concat([i]).join("\n")}var s,o,c;return[n].join("\n")}(e,t);return e[2]?"@media ".concat(e[2]," {").concat(n,"}"):n})).join("")},e.i=function(t,n,r){"string"==typeof t&&(t=[[null,t,""]]);var i={};if(r)for(var a=0;a<this.length;a++){var s=this[a][0];null!=s&&(i[s]=!0)}for(var o=0;o<t.length;o++){var c=[].concat(t[o]);r&&i[c[0]]||(n&&(c[2]?c[2]="".concat(n," and ").concat(c[2]):c[2]=n),e.push(c))}},e}},function(t,e,n){"use strict";n.r(e);class r{constructor(t){this._root=t,this.prepareTemplate()}get root(){return this._root}get template(){return this._template}prepareTemplate(){this._template=document.createElement("div")}initTemplate(){if(this._template)return this._template.innerHTML=""}render(t){t&&(this._root=t),this.initTemplate();const{root:e,template:n}=this;e&&e.appendChild(n)}}class i extends r{constructor(t){super(),this._data=t,this._counter=1}get id(){return this._data.id}get totalPrice(){return this._data.price*this._counter}inc(){return Promise.resolve(this._counter++).then(()=>{this.render()})}dec(){}del(){}initTemplate(){this._template&&(this._template.innerHTML=`\n      <div class="cart__item">\n        ${this._data.title} x ${this._counter} = ${this.totalPrice}\n      </div>\n    `)}}class a extends r{constructor(t={},e,n){super(n),this._cart=e,this._data=t}addInCart(){this._cart&&this._cart.add(this._data)}initTemplate(){if(!this._template)return;const{title:t,price:e}=this._data;this._template.className="item",this._template.innerHTML=`\n      <div class="item__img">\n        <div>NO IMAGE AVAILABLE</div>\n      </div>\n      <div class="item__meta">Товар: <span>${t}</span></div>\n      <div class="item__meta">Цена: <span>${e}</span></div>\n      <button class="btn btn_primary">Купить</button>\n    `;this._template.querySelector("button").addEventListener("click",this.addInCart.bind(this))}}n(0);console.log(123);const s=new class extends r{constructor(t){super(t),this._items=[],this.render()}add(t){const e=this._items.filter(e=>e.id===t.id)[0];return e?e.inc().then(()=>{this.totalCostTemplate()}):Promise.resolve(this._items.push(new i(t))).then(()=>{this.render()})}remove(t){}getTotalPrice(){return this._items.reduce((t,e)=>t+e.totalPrice,0)}toggle(){this._template&&this.template.classList.toggle("shown")}initTemplate(){this._template&&(this._template.className||(this._template.className="cart__list",this.root.addEventListener("click",this.toggle.bind(this))),this._items.length?(this._template.innerHTML="",this._items.forEach(t=>t.render(this._template)),this.totalCostTemplate()):this._template.innerHTML='\n        <div class="cart__empty">\n          Вы пока не добавили товары в корзину\n        </div>\n      ')}totalCostTemplate(){let t=document.querySelector(".cart__total");t||(t=document.createElement("div"),t.className="cart__total"),t.innerHTML=this.getTotalPrice(),this._template.appendChild(t)}}(document.querySelector(".cart"));new class extends r{constructor(t,e){super(t),this._cart=e,this.fetchData().then(this.render.bind(this))}fetchData(){return fetch("http://localhost:3000/database/items.json").then(t=>t.json()).then(t=>{this._items=t.data.map(t=>new a(t,this._cart))})}get items(){return this._items}initTemplate(){this._template&&(this._template.className="items-list",this.items.forEach(t=>t.render(this._template)))}}(document.querySelector("main"),s)}]);